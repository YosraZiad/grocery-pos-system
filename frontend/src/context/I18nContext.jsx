import { createContext, useContext, useState, useEffect } from 'react';

// ترجمات
const translations = {
  en: {
    // Navigation
    home: 'Home',
    categories: 'Categories',
    products: 'Products',
    sales: 'Sales',
    inventory: 'Inventory',
    returns: 'Returns',
    logout: 'Logout',
    
    // Auth
    login: 'Login',
    register: 'Register',
    email: 'Email',
    password: 'Password',
    loginButton: 'Sign In',
    registerButton: 'Sign Up',
    name: 'Name',
    confirmPassword: 'Confirm Password',
    createAccount: 'Create new account',
    or: 'Or',
    testAccounts: 'Test Accounts',
    admin: 'Admin',
    cashier: 'Cashier',
    
    // Home
    welcome: 'Welcome to Store Management System',
    welcomeDesc: 'An integrated system for managing a grocery store with Point of Sale system and inventory management',
    productManagement: 'Product Management',
    productManagementDesc: 'Manage products, categories, and inventory',
    salesScreen: 'Sales Screen',
    salesScreenDesc: 'Point of Sale system for quick sales',
    reports: 'Reports',
    reportsDesc: 'Comprehensive reports on sales and profits',
    
    // Categories
    manageCategories: 'Manage Categories',
    addCategory: 'Add New Category',
    editCategory: 'Edit Category',
    categoryName: 'Name',
    description: 'Description',
    productsCount: 'Products Count',
    actions: 'Actions',
    edit: 'Edit',
    delete: 'Delete',
    cancel: 'Cancel',
    save: 'Save',
    update: 'Update',
    confirmDelete: 'Are you sure you want to delete this category?',
    
    // Products
    manageProducts: 'Manage Products',
    addProduct: 'Add New Product',
    editProduct: 'Edit Product',
    productName: 'Product Name',
    barcode: 'Barcode',
    purchasePrice: 'Purchase Price',
    salePrice: 'Sale Price',
    quantity: 'Quantity',
    status: 'Status',
    available: 'Available',
    lowStock: 'Low Stock',
    searchPlaceholder: 'Search by name or barcode...',
    allCategories: 'All Categories',
    
    // Sales
    salesScreenTitle: 'Sales Screen',
    cart: 'Shopping Cart',
    emptyCart: 'Cart is empty',
    subtotal: 'Subtotal',
    discount: 'Discount',
    total: 'Total',
    paymentMethod: 'Payment Method',
    cash: 'Cash',
    card: 'Card',
    transfer: 'Transfer',
    fixed: 'Fixed',
    percentage: 'Percentage',
    completeSale: 'Complete Sale',
    processing: 'Processing...',
    tips: 'Tips',
    tip1: 'Search by name or barcode to add product',
    tip2: 'You can modify quantity from cart',
    tip3: 'You can add discount before completing sale',
    
    // Common
    loading: 'Loading...',
    error: 'Error',
    success: 'Success',
    close: 'Close',
    copyright: '© 2024 Grocery POS System. All rights reserved.',
    noCategories: 'No categories yet',
    confirmDelete: 'Are you sure you want to delete this item?',
    back: 'Back',
    print: 'Print',
    invoice: 'Invoice',
    
    // Inventory
    inventoryManagement: 'Inventory Management',
    manageAndMonitor: 'Manage and monitor your inventory',
    totalProducts: 'Total Products',
    lowStock: 'Low Stock',
    expiringSoon: 'Expiring Soon',
    expired: 'Expired',
    outOfStock: 'Out of Stock',
    stockStatus: 'Stock Status',
    expiryStatus: 'Expiry Status',
    expiryDate: 'Expiry Date',
    allStockStatus: 'All Stock Status',
    allExpiryStatus: 'All Expiry Status',
    lowStockAlert: 'Low Stock Alert',
    expiringSoonAlert: 'Expiring Soon',
    stock: 'Stock',
    min: 'Min',
    expires: 'Expires',
    days: 'days',
    inventoryTransactionsHistory: 'Inventory Transactions History',
    date: 'Date',
    product: 'Product',
    type: 'Type',
    reference: 'Reference',
    notes: 'Notes',
    allTypes: 'All Types',
    allReferences: 'All References',
    fromDate: 'From Date',
    toDate: 'To Date',
    showing: 'Showing',
    to: 'to',
    of: 'of',
    transactions: 'transactions',
    todaySales: 'Today Sales',
    valid: 'Valid',
    noExpiry: 'No Expiry',
    in: 'In',
    out: 'Out',
    return: 'Return',
    sale: 'Sale',
    purchase: 'Purchase',
    quickAndEasy: 'Quick and easy point of sale system',
    fullName: 'Full Name',
    confirmPasswordPlaceholder: 'Confirm Password',
    noResultsFound: 'No results found',
    availableQuantity: 'Available quantity',
    passwordMin: 'Password (min 8 characters)',
    
    // Sales List & Details
    salesList: 'Sales List',
    viewAndManageSales: 'View and manage all sales',
    newSale: 'New Sale',
    searchByInvoiceNumber: 'Search by invoice number...',
    clearFilters: 'Clear Filters',
    invoiceNumber: 'Invoice Number',
    user: 'User',
    items: 'Items',
    noSalesFound: 'No sales found',
    viewInvoice: 'View Invoice',
    cancelSale: 'Cancel Sale',
    confirmCancelSale: 'Are you sure you want to cancel this sale? This will return items to inventory.',
    saleCancelledSuccessfully: 'Sale cancelled successfully',
    saleDetails: 'Sale Details',
    saleInformation: 'Sale Information',
    summary: 'Summary',
    price: 'Price',
    saleNotFound: 'Sale not found',
    completed: 'completed',
    cancelled: 'cancelled',
    results: 'results',
    previous: 'Previous',
    next: 'Next',
    
    // Confirmation Modal
    confirmAction: 'Confirm Action',
    areYouSure: 'Are you sure?',
    confirm: 'Confirm',
    confirmSale: 'Confirm Sale',
    confirmSaleMessage: 'Are you sure you want to complete this sale?',
    
    // Discount Modal
    addDiscount: 'Add Discount',
    discountType: 'Discount Type',
    discountPercentage: 'Discount Percentage',
    discountAmount: 'Discount Amount',
    removeDiscount: 'Remove Discount',
    apply: 'Apply',
    
    // Quantity Control
    decrease: 'Decrease',
    increase: 'Increase',
    viewDetails: 'View Details',
    
    // Returns
    returnsManagement: 'Returns Management',
    manageReturns: 'Manage customer and supplier returns',
    addReturn: 'Add Return',
    customerReturn: 'Customer Return',
    supplierReturn: 'Supplier Return',
    allStatuses: 'All Statuses',
    pending: 'Pending',
    approved: 'Approved',
    rejected: 'Rejected',
    amount: 'Amount',
    reason: 'Reason',
    selectInvoice: 'Select Invoice',
    selectProduct: 'Select Product',
    autoApprove: 'Auto Approve',
    add: 'Add',
    returnCreatedSuccessfully: 'Return created successfully',
    returnUpdatedSuccessfully: 'Return updated successfully',
    noReturnsFound: 'No returns found',
    approve: 'Approve',
    reject: 'Reject',
    confirmApprovedReturn: 'Are you sure you want to approve this return? This will update inventory.',
    confirmRejectedReturn: 'Are you sure you want to reject this return?',
    
    // Suppliers
    suppliersManagement: 'Suppliers Management',
    manageSuppliers: 'Manage suppliers and their information',
    addSupplier: 'Add Supplier',
    editSupplier: 'Edit Supplier',
    searchSuppliers: 'Search suppliers...',
    phone: 'Phone',
    address: 'Address',
    totalBalance: 'Total Balance',
    invoicesCount: 'Invoices Count',
    noSuppliersFound: 'No suppliers found',
    supplierCreatedSuccessfully: 'Supplier created successfully',
    supplierUpdatedSuccessfully: 'Supplier updated successfully',
    supplierDeletedSuccessfully: 'Supplier deleted successfully',
    confirmDeleteSupplier: 'Are you sure you want to delete this supplier?',
    
    // Purchase Invoices
    purchaseInvoices: 'Purchase Invoices',
    managePurchaseInvoices: 'Manage purchase invoices from suppliers',
    addPurchaseInvoice: 'Add Purchase Invoice',
    allSuppliers: 'All Suppliers',
    paid: 'Paid',
    unpaid: 'Unpaid',
    paidAmount: 'Paid Amount',
    balance: 'Balance',
    selectSupplier: 'Select Supplier',
    items: 'Items',
    addItem: 'Add Item',
    noPurchaseInvoicesFound: 'No purchase invoices found',
    purchaseInvoiceCreatedSuccessfully: 'Purchase invoice created successfully',
    payInvoice: 'Pay Invoice',
    remainingBalance: 'Remaining Balance',
    paymentAmount: 'Payment Amount',
    pay: 'Pay',
    paymentProcessedSuccessfully: 'Payment processed successfully',
    amountMustBeGreaterThanZero: 'Amount must be greater than zero',
    amountCannotExceedBalance: 'Amount cannot exceed the remaining balance',
    
    // Expenses
    expensesManagement: 'Expenses Management',
    manageExpenses: 'Manage expenses and expense categories',
    addExpense: 'Add Expense',
    editExpense: 'Edit Expense',
    category: 'Category',
    selectCategory: 'Select Category',
    searchExpenses: 'Search expenses...',
    noExpensesFound: 'No expenses found',
    expenseCreatedSuccessfully: 'Expense created successfully',
    expenseUpdatedSuccessfully: 'Expense updated successfully',
    expenseDeletedSuccessfully: 'Expense deleted successfully',
    confirmDeleteExpense: 'Are you sure you want to delete this expense?',
    totalExpenses: 'Total Expenses',
    expensesCount: 'Expenses Count',
    averageExpense: 'Average Expense',
    showSummary: 'Show Summary',
    hideSummary: 'Hide Summary',
    expenses: 'expenses',
    categoryCreatedSuccessfully: 'Category created successfully',
    categoryUpdatedSuccessfully: 'Category updated successfully',
    categoryDeletedSuccessfully: 'Category deleted successfully',
    confirmDeleteCategory: 'Are you sure you want to delete this category?',
    
    // Profit & Loss
    profitLoss: 'Profit & Loss',
    profitLossDescription: 'Calculate profits and losses On-The-Fly from sales, expenses, and returns',
    totalSales: 'Total Sales',
    costOfGoods: 'Cost of Goods',
    grossProfit: 'Gross Profit',
    netProfit: 'Net Profit',
    details: 'Details',
    daily: 'Daily',
    monthly: 'Monthly',
    byProduct: 'By Product',
    byCategory: 'By Category',
    month: 'Month',
    year: 'Year',
    quantitySold: 'Quantity Sold',
    productsSold: 'Products Sold',
  },
  ar: {
    // Navigation
    home: 'الرئيسية',
    categories: 'الأقسام',
    products: 'المنتجات',
    sales: 'المبيعات',
    inventory: 'المخزون',
    returns: 'المرتجعات',
    logout: 'تسجيل الخروج',
    
    // Auth
    login: 'تسجيل الدخول',
    register: 'إنشاء حساب',
    email: 'البريد الإلكتروني',
    password: 'كلمة المرور',
    loginButton: 'تسجيل الدخول',
    registerButton: 'إنشاء حساب',
    name: 'الاسم',
    confirmPassword: 'تأكيد كلمة المرور',
    createAccount: 'إنشاء حساب جديد',
    or: 'أو',
    testAccounts: 'حسابات تجريبية',
    admin: 'مدير',
    cashier: 'كاشير',
    
    // Home
    welcome: 'مرحباً بك في نظام إدارة المتجر',
    welcomeDesc: 'نظام متكامل لإدارة متجر المواد الغذائية مع نظام نقاط البيع وإدارة المخزون',
    productManagement: 'إدارة المنتجات',
    productManagementDesc: 'إدارة المنتجات والأقسام والمخزون',
    salesScreen: 'شاشة المبيعات',
    salesScreenDesc: 'نظام نقاط البيع للبيع السريع',
    reports: 'التقارير',
    reportsDesc: 'تقارير شاملة عن المبيعات والأرباح',
    
    // Categories
    manageCategories: 'إدارة الأقسام',
    addCategory: 'إضافة قسم جديد',
    editCategory: 'تعديل قسم',
    categoryName: 'الاسم',
    description: 'الوصف',
    productsCount: 'عدد المنتجات',
    actions: 'الإجراءات',
    edit: 'تعديل',
    delete: 'حذف',
    cancel: 'إلغاء',
    save: 'حفظ',
    update: 'تحديث',
    confirmDelete: 'هل أنت متأكد من حذف هذا القسم؟',
    
    // Products
    manageProducts: 'إدارة المنتجات',
    addProduct: 'إضافة منتج جديد',
    editProduct: 'تعديل منتج',
    productName: 'اسم المنتج',
    barcode: 'الباركود',
    purchasePrice: 'سعر الشراء',
    salePrice: 'سعر البيع',
    quantity: 'الكمية',
    status: 'الحالة',
    available: 'متوفر',
    lowStock: 'منخفض',
    searchPlaceholder: 'بحث بالاسم أو الباركود...',
    allCategories: 'جميع الأقسام',
    
    // Sales
    salesScreenTitle: 'شاشة المبيعات',
    cart: 'سلة المشتريات',
    emptyCart: 'السلة فارغة',
    subtotal: 'الإجمالي الفرعي',
    discount: 'الخصم',
    total: 'الإجمالي',
    paymentMethod: 'طريقة الدفع',
    cash: 'نقدي',
    card: 'بطاقة',
    transfer: 'تحويل',
    fixed: 'قيمة ثابتة',
    percentage: 'نسبة مئوية',
    completeSale: 'إتمام البيع',
    processing: 'جاري المعالجة...',
    tips: 'نصائح',
    tip1: '• ابحث بالاسم أو الباركود لإضافة منتج',
    tip2: '• يمكنك تعديل الكمية من السلة',
    tip3: '• يمكنك إضافة خصم قبل إتمام البيع',
    
    // Common
    loading: 'جاري التحميل...',
    error: 'خطأ',
    success: 'نجح',
    close: 'إغلاق',
    copyright: '© 2024 Grocery POS System. جميع الحقوق محفوظة.',
    noCategories: 'لا توجد أقسام بعد',
    confirmDelete: 'هل أنت متأكد من حذف هذا العنصر؟',
    back: 'رجوع',
    print: 'طباعة',
    invoice: 'فاتورة',
    
    // Inventory
    inventoryManagement: 'إدارة المخزون',
    manageAndMonitor: 'إدارة ومراقبة المخزون',
    totalProducts: 'إجمالي المنتجات',
    lowStock: 'مخزون منخفض',
    expiringSoon: 'قريب الانتهاء',
    expired: 'منتهي الصلاحية',
    outOfStock: 'نفد المخزون',
    stockStatus: 'حالة المخزون',
    expiryStatus: 'حالة الصلاحية',
    expiryDate: 'تاريخ الانتهاء',
    allStockStatus: 'جميع حالات المخزون',
    allExpiryStatus: 'جميع حالات الصلاحية',
    lowStockAlert: 'تنبيه المخزون المنخفض',
    expiringSoonAlert: 'تنبيه قرب الانتهاء',
    stock: 'المخزون',
    min: 'الحد الأدنى',
    expires: 'ينتهي',
    days: 'أيام',
    inventoryTransactionsHistory: 'سجل حركة المخزون',
    date: 'التاريخ',
    product: 'المنتج',
    type: 'النوع',
    reference: 'المرجع',
    notes: 'ملاحظات',
    allTypes: 'جميع الأنواع',
    allReferences: 'جميع المراجع',
    fromDate: 'من تاريخ',
    toDate: 'إلى تاريخ',
    showing: 'عرض',
    to: 'إلى',
    of: 'من',
    transactions: 'عملية',
    todaySales: 'مبيعات اليوم',
    valid: 'صالح',
    noExpiry: 'بدون صلاحية',
    in: 'داخل',
    out: 'خارج',
    return: 'إرجاع',
    sale: 'بيع',
    purchase: 'شراء',
    quickAndEasy: 'نظام نقاط بيع سريع وسهل',
    fullName: 'الاسم الكامل',
    confirmPasswordPlaceholder: 'تأكيد كلمة المرور',
    noResultsFound: 'لا توجد نتائج',
    availableQuantity: 'الكمية المتاحة',
    passwordMin: 'كلمة المرور (8 أحرف على الأقل)',
    
    // Sales List & Details
    salesList: 'قائمة المبيعات',
    viewAndManageSales: 'عرض وإدارة جميع المبيعات',
    newSale: 'بيع جديد',
    searchByInvoiceNumber: 'بحث برقم الفاتورة...',
    clearFilters: 'مسح الفلاتر',
    invoiceNumber: 'رقم الفاتورة',
    user: 'المستخدم',
    items: 'عناصر',
    noSalesFound: 'لا توجد مبيعات',
    viewInvoice: 'عرض الفاتورة',
    cancelSale: 'إلغاء البيع',
    confirmCancelSale: 'هل أنت متأكد من إلغاء هذا البيع؟ سيتم إرجاع العناصر للمخزون.',
    saleCancelledSuccessfully: 'تم إلغاء البيع بنجاح',
    saleDetails: 'تفاصيل البيع',
    saleInformation: 'معلومات البيع',
    summary: 'الملخص',
    price: 'السعر',
    saleNotFound: 'البيع غير موجود',
    completed: 'مكتمل',
    cancelled: 'ملغي',
    results: 'نتيجة',
    previous: 'السابق',
    next: 'التالي',
    
    // Confirmation Modal
    confirmAction: 'تأكيد الإجراء',
    areYouSure: 'هل أنت متأكد؟',
    confirm: 'تأكيد',
    confirmSale: 'تأكيد البيع',
    confirmSaleMessage: 'هل أنت متأكد من إتمام هذا البيع؟',
    
    // Discount Modal
    addDiscount: 'إضافة خصم',
    discountType: 'نوع الخصم',
    discountPercentage: 'نسبة الخصم',
    discountAmount: 'قيمة الخصم',
    removeDiscount: 'إزالة الخصم',
    apply: 'تطبيق',
    
    // Quantity Control
    decrease: 'تقليل',
    increase: 'زيادة',
    viewDetails: 'عرض التفاصيل',
    
    // Returns
    returnsManagement: 'إدارة المرتجعات',
    manageReturns: 'إدارة مرتجعات العملاء والموردين',
    addReturn: 'إضافة مرتجع',
    customerReturn: 'إرجاع من زبون',
    supplierReturn: 'إرجاع لمورّد',
    allStatuses: 'جميع الحالات',
    pending: 'قيد الانتظار',
    approved: 'معتمد',
    rejected: 'مرفوض',
    amount: 'المبلغ',
    reason: 'السبب',
    selectInvoice: 'اختر الفاتورة',
    selectProduct: 'اختر المنتج',
    autoApprove: 'موافقة تلقائية',
    add: 'إضافة',
    returnCreatedSuccessfully: 'تم إنشاء المرتجع بنجاح',
    returnUpdatedSuccessfully: 'تم تحديث المرتجع بنجاح',
    noReturnsFound: 'لا توجد مرتجعات',
    approve: 'موافقة',
    reject: 'رفض',
    confirmApprovedReturn: 'هل أنت متأكد من الموافقة على هذا المرتجع؟ سيتم تحديث المخزون.',
    confirmRejectedReturn: 'هل أنت متأكد من رفض هذا المرتجع؟',
    
    // Suppliers
    suppliersManagement: 'إدارة الموردين',
    manageSuppliers: 'إدارة الموردين ومعلوماتهم',
    addSupplier: 'إضافة مورد',
    editSupplier: 'تعديل مورد',
    searchSuppliers: 'بحث عن موردين...',
    phone: 'الهاتف',
    address: 'العنوان',
    totalBalance: 'إجمالي الديون',
    invoicesCount: 'عدد الفواتير',
    noSuppliersFound: 'لا توجد موردين',
    supplierCreatedSuccessfully: 'تم إنشاء المورد بنجاح',
    supplierUpdatedSuccessfully: 'تم تحديث المورد بنجاح',
    supplierDeletedSuccessfully: 'تم حذف المورد بنجاح',
    confirmDeleteSupplier: 'هل أنت متأكد من حذف هذا المورد؟',
    
    // Purchase Invoices
    purchaseInvoices: 'فواتير الشراء',
    managePurchaseInvoices: 'إدارة فواتير الشراء من الموردين',
    addPurchaseInvoice: 'إضافة فاتورة شراء',
    allSuppliers: 'جميع الموردين',
    paid: 'مدفوع',
    unpaid: 'غير مدفوع',
    paidAmount: 'المبلغ المدفوع',
    balance: 'المتبقي',
    selectSupplier: 'اختر المورد',
    items: 'العناصر',
    addItem: 'إضافة عنصر',
    noPurchaseInvoicesFound: 'لا توجد فواتير شراء',
    purchaseInvoiceCreatedSuccessfully: 'تم إنشاء فاتورة الشراء بنجاح',
    payInvoice: 'دفع الفاتورة',
    remainingBalance: 'المتبقي',
    paymentAmount: 'مبلغ الدفع',
    pay: 'دفع',
    paymentProcessedSuccessfully: 'تم معالجة الدفع بنجاح',
    amountMustBeGreaterThanZero: 'يجب أن يكون المبلغ أكبر من الصفر',
    amountCannotExceedBalance: 'لا يمكن أن يتجاوز المبلغ المتبقي',
    
    // Expenses
    expensesManagement: 'إدارة المصروفات',
    manageExpenses: 'إدارة المصروفات وأقسام المصروفات',
    addExpense: 'إضافة مصروف',
    editExpense: 'تعديل مصروف',
    category: 'القسم',
    selectCategory: 'اختر القسم',
    searchExpenses: 'بحث عن مصروفات...',
    noExpensesFound: 'لا توجد مصروفات',
    expenseCreatedSuccessfully: 'تم إنشاء المصروف بنجاح',
    expenseUpdatedSuccessfully: 'تم تحديث المصروف بنجاح',
    expenseDeletedSuccessfully: 'تم حذف المصروف بنجاح',
    confirmDeleteExpense: 'هل أنت متأكد من حذف هذا المصروف؟',
    totalExpenses: 'إجمالي المصروفات',
    expensesCount: 'عدد المصروفات',
    averageExpense: 'متوسط المصروف',
    showSummary: 'عرض الملخص',
    hideSummary: 'إخفاء الملخص',
    expenses: 'مصروفات',
    categoryCreatedSuccessfully: 'تم إنشاء القسم بنجاح',
    categoryUpdatedSuccessfully: 'تم تحديث القسم بنجاح',
    categoryDeletedSuccessfully: 'تم حذف القسم بنجاح',
    confirmDeleteCategory: 'هل أنت متأكد من حذف هذا القسم؟',
    
    // Profit & Loss
    profitLoss: 'الأرباح والخسائر',
    profitLossDescription: 'حساب الأرباح والخسائر مباشرة من المبيعات والمصروفات والمرتجعات',
    totalSales: 'إجمالي المبيعات',
    costOfGoods: 'تكلفة البضاعة',
    grossProfit: 'الربح الإجمالي',
    netProfit: 'الربح الصافي',
    details: 'التفاصيل',
    daily: 'يومي',
    monthly: 'شهري',
    byProduct: 'حسب منتج',
    byCategory: 'حسب قسم',
    month: 'الشهر',
    year: 'السنة',
    quantitySold: 'الكمية المباعة',
    productsSold: 'المنتجات المباعة',
  },
};

const I18nContext = createContext();

export function I18nProvider({ children }) {
  const [language, setLanguage] = useState(() => {
    return localStorage.getItem('language') || 'en';
  });

  useEffect(() => {
    localStorage.setItem('language', language);
    document.documentElement.dir = language === 'ar' ? 'rtl' : 'ltr';
    document.documentElement.lang = language;
  }, [language]);

  const t = (key) => {
    return translations[language]?.[key] || key;
  };

  const toggleLanguage = () => {
    setLanguage((prev) => (prev === 'en' ? 'ar' : 'en'));
  };

  return (
    <I18nContext.Provider value={{ language, setLanguage, toggleLanguage, t }}>
      {children}
    </I18nContext.Provider>
  );
}

export function useI18n() {
  const context = useContext(I18nContext);
  if (!context) {
    throw new Error('useI18n must be used within I18nProvider');
  }
  return context;
}
